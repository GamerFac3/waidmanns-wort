---
import { SITE_TITLE, CATEGORIES } from '../consts';
import SearchInput from './ui/SearchInput.astro';

const currentPath = Astro.url.pathname;
---

<header class="sticky top-0 z-50 glass-dark shadow-lg">
	<nav class="max-w-7xl mx-auto px-4">
		<!-- Top Bar -->
		<div class="flex items-center justify-between h-16">
			<!-- Logo -->
			<a href="/" class="flex items-center gap-3 text-[#faf8f3] no-underline group">
				<div class="w-10 h-10 bg-[#c9a54e] rounded-full flex items-center justify-center shadow-md group-hover:scale-105 group-hover:ring-2 group-hover:ring-[#c9a54e]/50 transition-all">
					<svg class="w-6 h-6 text-[#2d3e28]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z" />
					</svg>
				</div>
				<span class="text-xl font-bold hidden sm:block group-hover:text-[#c9a54e] transition-colors">{SITE_TITLE}</span>
			</a>

			<!-- Desktop Navigation -->
			<div class="hidden md:flex items-center gap-8">
				<a
					href="/"
					class:list={[
						'relative text-sm font-medium transition-colors py-1',
						currentPath === '/' ? 'text-[#c9a54e]' : 'text-[#faf8f3]/80 hover:text-[#faf8f3]'
					]}
				>
					Startseite
					<span class:list={[
						'absolute bottom-0 left-0 h-0.5 bg-[#c9a54e] transition-all duration-300',
						currentPath === '/' ? 'w-full' : 'w-0 group-hover:w-full'
					]}></span>
				</a>
				<div class="relative group">
					<button class="flex items-center gap-1 text-sm font-medium text-[#faf8f3]/80 hover:text-[#faf8f3] transition-colors py-1">
						Kategorien
						<svg class="w-4 h-4 transition-transform duration-300 group-hover:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
						</svg>
					</button>
					<!-- Dropdown -->
					<div class="absolute top-full left-1/2 -translate-x-1/2 pt-4 opacity-0 invisible translate-y-2 group-hover:opacity-100 group-hover:visible group-hover:translate-y-0 transition-all duration-300">
						<!-- Decorative arrow -->
						<div class="absolute top-2 left-1/2 -translate-x-1/2 w-3 h-3 bg-white rotate-45 border-l border-t border-gray-100"></div>
						<div class="relative bg-white rounded-xl shadow-xl py-2 min-w-[220px] border border-gray-100">
							<a href="/kategorien" class="flex items-center gap-2 px-4 py-2.5 text-sm text-[#2d3e28] hover:bg-[#4a6741]/10 font-medium group/item">
								<span class="w-1.5 h-1.5 rounded-full bg-[#c9a54e]"></span>
								Alle Kategorien
							</a>
							<div class="border-t border-gray-100 my-1"></div>
							{CATEGORIES.map((cat) => (
								<a
									href={`/kategorien/${cat.id}`}
									class="flex items-center gap-2 px-4 py-2 text-sm text-gray-600 hover:bg-[#4a6741]/10 hover:text-[#2d3e28] transition-colors group/item"
								>
									<span class="w-1 h-1 rounded-full bg-gray-300 group-hover/item:bg-[#c9a54e] transition-colors"></span>
									{cat.name}
								</a>
							))}
						</div>
					</div>
				</div>
				<a
					href="/about"
					class:list={[
						'relative text-sm font-medium transition-colors py-1 group/link',
						currentPath === '/about' ? 'text-[#c9a54e]' : 'text-[#faf8f3]/80 hover:text-[#faf8f3]'
					]}
				>
					Über mich
					<span class:list={[
						'absolute bottom-0 left-0 h-0.5 bg-[#c9a54e] transition-all duration-300',
						currentPath === '/about' ? 'w-full' : 'w-0 group-hover/link:w-full'
					]}></span>
				</a>
			</div>

			<!-- Search & Mobile Menu -->
			<div class="flex items-center gap-3">
				<SearchInput size="sm" class="hidden sm:block w-48 lg:w-64" />

				<!-- Mobile Menu Button -->
				<button
					id="mobile-menu-btn"
					class="md:hidden p-2 text-[#faf8f3] hover:bg-white/10 rounded-lg transition-colors"
					aria-label="Menu"
				>
					<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
					</svg>
				</button>
			</div>
		</div>
	</nav>

	<!-- Mobile Menu -->
	<div id="mobile-menu" class="hidden md:hidden bg-[#2d3e28] border-t border-white/10">
		<div class="px-4 py-4 space-y-3">
			<SearchInput size="sm" class="sm:hidden" />

			<a href="/" class="block py-2 text-[#faf8f3] font-medium hover:text-[#c9a54e]">
				Startseite
			</a>
			<a href="/kategorien" class="block py-2 text-[#faf8f3] font-medium hover:text-[#c9a54e]">
				Alle Kategorien
			</a>
			<div class="pl-4 space-y-1 border-l-2 border-[#4a6741]">
				{CATEGORIES.slice(0, 5).map((cat) => (
					<a
						href={`/kategorien/${cat.id}`}
						class="block py-1.5 text-sm text-[#faf8f3]/70 hover:text-[#faf8f3]"
					>
						{cat.name}
					</a>
				))}
				<a href="/kategorien" class="block py-1.5 text-sm text-[#c9a54e] hover:text-[#c9a54e]/80">
					Mehr anzeigen...
				</a>
			</div>
			<a href="/about" class="block py-2 text-[#faf8f3] font-medium hover:text-[#c9a54e]">
				Über mich
			</a>
		</div>
	</div>
</header>

<script>
	const menuBtn = document.getElementById('mobile-menu-btn');
	const mobileMenu = document.getElementById('mobile-menu');

	menuBtn?.addEventListener('click', () => {
		mobileMenu?.classList.toggle('hidden');
	});
</script>
