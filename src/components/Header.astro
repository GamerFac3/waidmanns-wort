---
import { SITE_TITLE, CATEGORIES } from '../consts';
import SearchInput from './ui/SearchInput.astro';

const currentPath = Astro.url.pathname;
---

<header class="sticky top-0 z-50 bg-[#2d3e28]/95 backdrop-blur-md shadow-lg">
	<nav class="max-w-6xl mx-auto px-4">
		<!-- Top Bar -->
		<div class="flex items-center justify-between h-16">
			<!-- Logo -->
			<a href="/" class="flex items-center gap-3 text-[#faf8f3] no-underline group">
				<div class="w-10 h-10 bg-[#c9a54e] rounded-full flex items-center justify-center shadow-md group-hover:scale-105 transition-transform">
					<svg class="w-6 h-6 text-[#2d3e28]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z" />
					</svg>
				</div>
				<span class="text-xl font-bold hidden sm:block">{SITE_TITLE}</span>
			</a>

			<!-- Desktop Navigation -->
			<div class="hidden md:flex items-center gap-6">
				<a
					href="/"
					class:list={[
						'text-sm font-medium transition-colors',
						currentPath === '/' ? 'text-[#c9a54e]' : 'text-[#faf8f3]/80 hover:text-[#faf8f3]'
					]}
				>
					Startseite
				</a>
				<div class="relative group">
					<button class="flex items-center gap-1 text-sm font-medium text-[#faf8f3]/80 hover:text-[#faf8f3] transition-colors">
						Kategorien
						<svg class="w-4 h-4 transition-transform group-hover:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
						</svg>
					</button>
					<!-- Dropdown -->
					<div class="absolute top-full left-0 pt-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200">
						<div class="bg-white rounded-xl shadow-xl py-2 min-w-[200px] border border-gray-100">
							<a href="/kategorien" class="block px-4 py-2 text-sm text-[#2d3e28] hover:bg-[#4a6741]/10 font-medium">
								Alle Kategorien
							</a>
							<div class="border-t border-gray-100 my-1"></div>
							{CATEGORIES.map((cat) => (
								<a
									href={`/kategorien/${cat.id}`}
									class="block px-4 py-2 text-sm text-gray-700 hover:bg-[#4a6741]/10 hover:text-[#2d3e28]"
								>
									{cat.name}
								</a>
							))}
						</div>
					</div>
				</div>
				<a
					href="/about"
					class:list={[
						'text-sm font-medium transition-colors',
						currentPath === '/about' ? 'text-[#c9a54e]' : 'text-[#faf8f3]/80 hover:text-[#faf8f3]'
					]}
				>
					Über mich
				</a>
			</div>

			<!-- Search & Mobile Menu -->
			<div class="flex items-center gap-3">
				<SearchInput size="sm" class="hidden sm:block w-48 lg:w-64" />

				<!-- Mobile Menu Button -->
				<button
					id="mobile-menu-btn"
					class="md:hidden p-2 text-[#faf8f3] hover:bg-white/10 rounded-lg transition-colors"
					aria-label="Menu"
				>
					<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
					</svg>
				</button>
			</div>
		</div>
	</nav>

	<!-- Mobile Menu -->
	<div id="mobile-menu" class="hidden md:hidden bg-[#2d3e28] border-t border-white/10">
		<div class="px-4 py-4 space-y-3">
			<SearchInput size="sm" class="sm:hidden" />

			<a href="/" class="block py-2 text-[#faf8f3] font-medium hover:text-[#c9a54e]">
				Startseite
			</a>
			<a href="/kategorien" class="block py-2 text-[#faf8f3] font-medium hover:text-[#c9a54e]">
				Alle Kategorien
			</a>
			<div class="pl-4 space-y-1 border-l-2 border-[#4a6741]">
				{CATEGORIES.slice(0, 5).map((cat) => (
					<a
						href={`/kategorien/${cat.id}`}
						class="block py-1.5 text-sm text-[#faf8f3]/70 hover:text-[#faf8f3]"
					>
						{cat.name}
					</a>
				))}
				<a href="/kategorien" class="block py-1.5 text-sm text-[#c9a54e] hover:text-[#c9a54e]/80">
					Mehr anzeigen...
				</a>
			</div>
			<a href="/about" class="block py-2 text-[#faf8f3] font-medium hover:text-[#c9a54e]">
				Über mich
			</a>
		</div>
	</div>
</header>

<script>
	const menuBtn = document.getElementById('mobile-menu-btn');
	const mobileMenu = document.getElementById('mobile-menu');

	menuBtn?.addEventListener('click', () => {
		mobileMenu?.classList.toggle('hidden');
	});
</script>
